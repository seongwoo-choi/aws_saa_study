# EFS 개요

### EFS - Elastic File System

- EFS 는 대다수의 EC2 인스턴스에서 마운트하는 Managed NFS(Network File System) 이다.
- EBS 는 하나의 가용 영역의 EC2 인스턴스에만 사용할 수 있는 반면, EFS 는 여러 가용 영역의 EC2 인스턴스에서 사용할 수 있다.
- 높은 가용성과 확장 가능성이 있지만 매우 비싸고(gp2 의 요금에 3배), 사용한 만큼 비용을 지불한다.
- 주 사용처는 콘텐츠 관리, 웹 서빙, 데이터 공유 혹은 워드프레스 웹사이트에서 사용된다.
- NFSv4.1 프로토콜을 사용한다.(네트워크 드라이브를 탑재하고 EFS 파일 시스템에 접근하기 위한 표준 프로토콜 방식이다..)
- 네트워크 보안을 위해서 EFS 에 접근할 때는 반드시 보안 그룹을 사용해야 한다.
- EFS 는 AMI 기반의 Linux 에서만 작동한다. 윈도우에서는 작동하지 않는다.. 윈도우 인스턴스는 EFS 를 파일시스템으로 사용하지 않는다.
- EFS 를 암호화하기 위해 KMS 키를 사용한다.
- EFS 는 표준 파일 시스템 API 인 POSIX 파일 시스템에서만 작동한다. 즉, 기본적으로 리눅스에서는 작동한다는 뜻이다.

### EFS - Performance & Storage Classes

#### EFS Scale
- 수천명의 NFS 고객들을 지원하고, 사용량은 초당 10GB 이상이 될 수 있다.
- 파일 시스템의 크기가 페타바이트 규모로 커질 수 있고, 관리를 해줄 필요가 없다.

#### Performance mode 
- General Purpose (기본) : 파일에 접근할 때 걸리는 시간이 적다. 예를 들어 워드프레스 블로그의 경우, 파일시스템으로 EFS 를 사용하게 될 것이다. 블로그의 특성상 엄청나게 많은 파일들이 생길텐데 그런 파일들에 빠르게 접근할 수 있게 된다. 
- Max I/O : EFS 를 사용할 때 I/O 가 높아야 하는 경우도 있다. 그러면 데이터를 불러들이는 속도는 낮아지지만 처리량은 많아질 것이다. 그래서 빅데이터나 영상 처리에 적합한 모드이다.
- Throughput mode : 
  - Bursting(default) : 이 말은 1테라바이트를 저장한다고 하면 초당 50Mb 의 속도로 처리하지만 초당 최대 100Mb 까지 속도를 끌어올릴 수 있다는 뜻이다.
  - Provisioned : 처리량이 저장 용량 크기에 관계없도록 설정한다. 예를 들어, 1테라바이트의 저장 공간 밖에 없다 하더라도, 1초당 1기가 바이트의 처리량을 요구할 수 있다. 정말 작은 파일 시스템을 갖고 있지만 고성능의 처리량이 필요하다면 EFS 의 Provisioned Throughput mode 를 사용한다.
  - Storage Tiers : 이건 파일의 수명 주기 관리 기능으로 30일 후에 파일을 새로운 계층으로 이동시킨다. 
    - Standard : 자주 사용하는 파일일 경우 사용한다.
    - Infrequent access (EFS-IA) : 자주 사용하지 않는 파일일 경우 사용하고, 가격대가 비교적 낮다. 파일을 검색할 때마다 비용이 발생한다.
