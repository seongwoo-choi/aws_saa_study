# API Gateway

- AWS 에서 제공하는 서버리스 서비스이고 클라이언트가 접근 가능한 public REST API 를 생성할 수 있게 해준다. 클라이언트는 API 게이트웨이와 통신을 하게 된다.
- 람다 함수에서 오는 요청을 프록시해준다.
- API 게이트웨이를 사용하는 이유는 HTTP 엔드포인트보다 많은 기능을 제공하기 때문이다.
- 인증, 사용량 설정, 개발 단계를 비롯한 여러 기능이 있기 때문이다.
- Lambda 와 통합이 가능하고 서버리스 서비스이기 때문에 인프라를 관리할 필요가 없으며 WebSocket 프로토콜도 지원하기 때문에 API 게이트웨이를 통해 실시간으로 스트리밍이 가능하다.
- API 게이트웨이가 API 버전 관리를 해주기 때문에 여러 환경을 다루는데 아주 유용하다. 개발 및 테스트, 운영 환경으로 버전을 나눠서 관리할 수 있다는 뜻이다.
- API 게이트웨이는 보안 상 안전해야 하기 때문에 API 게이트웨이 보안 활성(인증과 권한)을 위한 수단이 많다.
- API 키를 생성하거나 클라이언트가 API 게이트웨이에 너무 많은 요청을 보낼 경우 요청량을 조절할 수도 있다.
- Swagger, Open API 3.0 등 일반적으로 사용되는 녀석들을 이용해서 미리 만들어진 API 를 빠르게 가져오고 내보낼 수도 있다.
- 주로, HTTP 엔드 포인트 위에 API 게이트웨이가 있는 구조를 사용한다. API 게이트웨이를 통해 비율 제한과 캐싱, 사용자 인증, API 키를 이용할 수 있기 때문이다.
- 다른 AWS Service 와 연동이 간편하다. API 게이트웨이의 API 를 사용하여 SQS 에 메시지를 바로 보낼 수 있다. 이렇게 사용할 경우 AWS 인증을 추가하고, 해당 API 를 공용으로 배포할 때 유용하다.

### API Gateway - Endpoint Types

- Edge-Optimized(디폴트)
  - 글로벌 클라이언트를 위한 것으로 전 세계에서 접근 가능하고 효율성을 위해 모든 CloudFront 의 엣지 로케이션에서 요청 라우팅으로 지연 시간을 개선한다.
  - API 게이트웨이는 처음 생성된 리전에만 존재하지만 엣지 로케이션을 사용하여 효율적으로 접근 가능하다.
- Regional
  - 모든 사용자가 API 게이트웨이를 생성한 리전에 있다고 예상될 경우 Regional 옵션을 사용한다.
  - 캐싱 전략과 CloudFront 설정을 상세하게 제어할 수 있다.
- Private
  - 사설 API 게이트웨이는 공용이 아니기 때문에 VPC 엔드 포인트 인터페이스(ENI) 를 통해서 액세스 된다.
  - 리소스 정책을 사용하여 API 게이트웨이 액세스를 정의한다.