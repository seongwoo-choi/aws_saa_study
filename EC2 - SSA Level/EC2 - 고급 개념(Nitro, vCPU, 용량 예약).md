# EC2 - 고급 개념(Nitro, vCPU, 용량 예약)

시험에 나올 수 있는 EC2 고급 주제에 대해서 알아보자

첫 번째로 EC2 Nitro 이다.

### EC2 Nitro 는 현재 사용중인 차세대 EC2 인스턴스의 기본 플랫폼 이름이다.

새로운 가상화 기술을 사용하고 있으며, 더 나은 성능을 지원한다.
- 네트워킹 HPC 가 향상되어 고성능 컴퓨팅 및 IPv6 지원이 가능하다.
- 최대 64000 IOPS 로 EBS 볼륨을 원한다면 EC2 Nitro 를 사용해야 한다, 만약 최대 32000 IOPS 만 원한다면 일반 EC2 인스턴스를 사용하면 된다.
- 기본적인 보안이 향상되었다.
- EC2 Nitro 를 사용하는 인스턴스 유형은 아래와 같다.
![image](https://user-images.githubusercontent.com/67403886/156995504-5b2681a7-5413-4791-844b-f1499dbad9ed.png)
![image](https://user-images.githubusercontent.com/67403886/156995594-e8bdb2d6-b7e6-4eed-a708-bfa595d41ab4.png)

중요한 것은 더 빠른 속도의 EBS Volume 이 필요하거나, 최대 64000 의 IOPS 속도가 필요하다면 EC2 Nitro 유형의 인스턴스를 사용해야 한다는 것이다.
 
### 두 번째로 vCPUs 이다.
- 하나의 CPU 에서 멀티 쓰레드를 실행할 수 있게 한다.(멀티 쓰레딩)
- 각각의 쓰레드는 AWS 의 vCPU 즉, 가상 CPU 를 나타낸다.
- 예를 들어, m5.2xlarge 인스턴스를 실행했을 경우 인스턴스에는 4개의 코어가 존재하고, 해당 CPU 코어 안에는 2개의 쓰레드가 있다.
총 8개의 쓰레드가 존재하는 것이다. 다시 말해서 8개의 쓰레드 == 8개의 vCPU 를 갖게 된다.
![image](https://user-images.githubusercontent.com/67403886/157030545-4f05f1b9-efb0-4730-9a95-87091180537f.png)
- AWS 에서는 몇 개의 CPU 코어를 갖는지, 몇개의 쓰레드가 존재하는지를 나타내지 않고 몇 개의 vCPU 를 갖는지만 알려주는데, 이 방식은 무척이나 효율적인 방식이다.
만약, 2 코어 CPU 에서 각 CPU 코어 안에는 2개의 쓰레드가 존재한다. 하지만 내가 사용하는 어플리케이션을 돌리는데 4개의 쓰레드를 가질 필요는 없다. 
그래서 쓰레드의 갯수를 줄여 코어 하나당 하나의 쓰레드를 사용하고 싶다고 요청해서 사용할 수 있는 것이다. 이런식으로 요금을 줄일 수 있다.
- vCPU 를 선택하는 것은 인스턴스를 실행하기 전, 설정 단계에서 가능하다.

예를 들어, r4.2xlarge 인스턴스 유형의 경우 기본 vCPU 가 8인 것을 확인할 수 있다.

4개의 CPU 가 코어 하나 당 2개의 쓰레드를 갖고 있다는 뜻이다. 

또한, 최대한 많이 가질수 있는 코어 수는 4개이며 각 코어 당 최대로 가질 수 있는 쓰레드의 수도 2개인 것을 확인할 수 있다.

![image](https://user-images.githubusercontent.com/67403886/157031694-5c505835-a51a-4fd6-a0dc-11d2272dabc0.png)

### 마지막으로는 EC2 - Capacity Reservations(용량 예약) 이다. 

- EC2 용량 예약은 내가 EC2 인스턴스를 시작할 때의 용량을 확실하게 정해준다.
- 예약에 대한 메뉴얼이나 종료 날짜가 존재한다. 여기서 말하는 예약이 매우 짧은 기간을 갖는 예약이라는 것이다.
- 즉, 1년 또는 3년 동안 해당 인스턴스를 사용해야 하는 약정을 할 필요가 없다.
- 용량 예약을 재지정만 하면 되고, 그 즉시 실행되며 바로 요금이 청구된다.

예약할 수 있는 용량을 지정하면 원하는 인스턴스의 유형을 선택할 수 있고 원하는 만큼의 가용 영역에서 원한는 만큼의 갯수로 인스턴스 예약을 할 수 있다.

특정 기간동안 특정 유형의 가용 영역에서 인스턴스를 시작할 수 있는지 확인하고 예약하고 싶을 경우에는 EC2 - Capacity Reservations 를 사용하는 것이 좋다.

![image](https://user-images.githubusercontent.com/67403886/157032863-48b855a3-a485-4afe-b576-80f8db8a8498.png)
