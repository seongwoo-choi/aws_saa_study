# S3 복제

- Amazon S3 복제인 리전 간 복제(CRR)과 동일 리전 복제(SRR)에 대해 살펴보자.
- 한 리전에 S3 버킷이 있고, 그 버킷을 비동기적으로 다른 리전의 버킷에 복제하려고 한다.
- 이를 위해서는 우선 출발지 버킷과 도착지 버킷에서 버저닝을 활성화해야 한다.
- 두 개의 버킷이 서로 다른 리전에 있는 경우에는 리전 간 복제(CRR)를, 두 버킷이 같은 리전에 있다면 동일 리전 복제(SRR)을 설정할 수 있다.
- 버킷이 서로 다른 계정에 있을 수도 있다. S3 복제를 통해 버킷의 객체들을을 또 다른 계정에 저장할 수 있다.
- 복제는 비동기적으로 발생하고 아주 빠르게 복제가 이뤄진다. 또한 복제를 하기 위해서는 IAM 역할을 생성해야 한다.
- IAM 역할은 A 라는 버킷을 B 라는 버킷으로 복제할 권한을 갖게 해야 한다.
- CRR 리전 간 복제는 주로 데이터 액세스 지연 시간 단축을 할 때 사용되거나, 다른 계정에 버킷을 복제할 때 사용된다.
- SRR 동일 리전 복제는 주로 로그 집계에 사용된다. 여러 로깅 버킷을 하나의 버킷으로 집중화하는 케이스이다. 혹은 프로덕션과 테스트 계정 사이를 실시간으로 복제할 때 사용되기도 한다.

### S3 Replication 주의 사항

- S3 복제 기능을 활성화 한 후에는 그 전 객체를 복제할 수 없다. 활성화 한 시점 이후에 저장되는 객체들만 복제가 가능하다.
- 삭제 마커를 복제할지 안할지 선택할 수 있는 옵션이 존재한다.
- 객체의 특정 버전 ID 를 복제하지 못하도록 설정할 수 있다.
- 복제가 연쇄적으로 되지는 않는다. 만약 버킷 1이 버킷 2로부터 복제되었고 버킷 2가 버킷 3으로 복제된 경우 버킷 1에서 생성되는 객체는 버킷 2에도 생성되지만 버킷 3으로는 복제되지 않는다. 복제가 연쇄적으로 발생하지 않는 것. 